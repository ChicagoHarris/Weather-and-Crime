<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>CrimeScape by CivicScape</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-light.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header">CrimeScape</h1>
        <p class="header">Understanding the data and model</p>

        <ul>
          <!--<li class="download"><a class="buttons" href="https://github.com/ChicagoHarris/Weather-and-Crime/zipball/master">Download ZIP</a></li>
          <li class="download"><a class="buttons" href="https://github.com/ChicagoHarris/Weather-and-Crime/tarball/master">Download TAR</a></li>-->
          <li><a class="buttons" href="#">View Site</a></li>
          <li><a class="buttons github" href="https://github.com/ChicagoHarris/Weather-and-Crime">View On GitHub</a></li>
        </ul>

        <p class="header">This project is maintained by <a class="header name" href="https://github.com/CivicScape">CivicScape</a></p>


      </header>
      <section>
      <h1>
<a id="how-it-works" class="anchor" href="#how-it-works" aria-hidden="true"><span class="octicon octicon-link"></span></a>How it works</h1>

        <p>CrimeScape predicts when and where violent criminal activity is likely to occur. Currently, the model predicts the relative likelihood of sudden violent criminal activity (shootings and homicides, aggravated assaults, and armed robberies) down to the hour and census tract area. CrimeScape calculates the relative chance of crime in each census tract compared to the citywide average at a given hour, and indicates if this prediction is surprising compared to what we would usually expect for this area -- that is, higher than 95% of recent historical values for that area at comparable times.</p>

<p>So far, CrimeScape’s overall predictions are accurate 70% of the time on average. The methodology and data used for calculating the predictions are explained here. You can also see the underlying code in our <a href="https://github.com/ChicagoHarris/Weather-and-Crime">Github repo</a>.</p>


<h2>
<a id="data" class="anchor" href="#data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Data</h2>

<p>CrimeScape generates its predictions using only data that is open and available to the public from the following sources.</p>

<h4>
<a id="weather-forecasts" class="anchor" href="#weather-forecasts" aria-hidden="true"><span class="octicon octicon-link"></span></a>Weather Forecasts</h4>

<p>Temperature, precipitation, relative humidity, wind speed from the <a href="http://forecast.weather.gov/MapClick.php?CityName=Chicago&amp;state=IL&amp;site=LOT&amp;textField1=41.837&amp;textField2=-87.685&amp;e=1#.VljQ9t-rSu6">National Oceanic and Atmospheric Administration (NOAA)</a></p>

<h4>
<a id="past-weather-activity" class="anchor" href="#past-weather-activity" aria-hidden="true"><span class="octicon octicon-link"></span></a>Past Weather Activity</h4>

<p>Temperature, precipitation, relative humidity, wind speed from <a href="http://plenar.io/">Plenar.io</a> via NOAA</p>

<h4>
<a id="past-crime-activity" class="anchor" href="#past-crime-activity" aria-hidden="true"><span class="octicon octicon-link"></span></a>Past Crime Activity</h4>

<p>Robbery count per census tract, assault count per census tract, shooting and homicide count per census tract from <a href="http://plenar.io/explore#detail/obs_date__le=2015%2F10%2F21&amp;obs_date__ge=2015%2F07%2F23&amp;agg=week&amp;dataset_name=crimes_2001_to_present&amp;resolution=500">Plenar.io</a> via the Chicago Data Portal</p>

<h2>
<a id="model" class="anchor" href="#model" aria-hidden="true"><span class="octicon octicon-link"></span></a>Model</h2>

<p>CrimeScape uses public data and a feed-forward neural network model to understand and predict patterns of violent crime activity. Our model differs from other crime prediction models in several ways:</p>

<ul>
<li>It calculates not just the absolute chance of crime, but the relative chance for a given area at a given time compared to the rest of the city.</li>
<li>It analyzes not just static environmental factors, but changes in environmental variables over a specific time period, such as the speed of changes in weather.</li>
<li>Since crime is a relatively rare event, the model creates a dataset with a more balanced distribution of instances of crime and no-crime to allow for better understanding of the conditions under which crime does occur. This technique of decreasing the sampling rate of no-crime occurrences at an optimal rate is called “downsampling.”</li>
</ul>

<h2>
<a id="downsampling" class="anchor" href="#downsampling" aria-hidden="true"><span class="octicon octicon-link"></span></a>Downsampling</h2>

<p>In the CrimeScape model, crime occurrences within each hour and tract are represented by 1 and no-crime occurrences are represented by 0. A challenge of using machine learning for crime prediction is that crime occurrences are rare events compared to no-crime occurrences. This can lead the algorithm to under-predict crime overall because it looks like, in general, there is low likelihood of crime happening.</p>

<p>In addition to this, increasing the proportion of positive observations in the dataset allows the algorithm to learn which variables/circumstances under which crime is likely to occur. In an unbalanced dataset, there are not enough positive cases to determine which variables are important for predicting crime. To compensate for this, the model “downsamples” (or decreases the sampling rate of) no-crime occurrences to crime occurrences at a ratio of 1:1. This ratio was determined to be optimal using an <a href="https://www.kaggle.com/wiki/MeanFScore">F1 score accuracy test</a>.</p>

<h2>
<a id="generating-overall-predictions" class="anchor" href="#generating-overall-predictions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Generating Overall Predictions</h2>

<p>The model utilizes an ensemble of feed-forward neural networks each trained on downsampled non-crime occurrences. The model relies on 100 separately downsampled subsets of the data for the City of Chicago overall. Each of these subsets is trained in a separate neural network.</p>

<p>The initial models are trained using a neural network model that iterates up to 200 times through interconnected nodes with varying weights attempting to provide an accurate output classification based on the training data. On each iteration, the internal weights of the model (how each variable interacts with each other, many times over) are adjusted to minimize the loss function (a calculation of how far off the classification of the training observations are) on the initial run until the loss function is no longer able to decrease. This is known as stochastic gradient descent.</p>

<p>The models can be updated weekly, by training with all of the initial data plus the most recent week of data available. The updating process is easier if done by starting with the previously trained (i.e. previous week's) neural network models. The old models allow the training process to start the stochastic gradient descent earlier. The new data is then introduced into the model, and the model runs again to continue to minimize the loss function by looking at random samples of the training data. The models converge much quicker when they have pre-calculated weights and a small amount of new data. The weights should only adjust slightly and the training time is drastically reduced.  This allows the models to take new data into account without adding too much additional training time.</p>

<p>The model generates a number of predictions for each census tract at a given hour with slightly different initial conditions. The raw prediction for each census tract is a weighted average of those predictions based on historical performance. We then compare the raw prediction for each census tract to the citywide mean to compute the final relative chance of crime that is displayed on Crimescape.</p>

<h2>
<a id="why-relative-chance" class="anchor" href="#why-relative-chance" aria-hidden="true"><span class="octicon octicon-link"></span></a>Relative Chance of Crime and Surprise Factor</h2>

<p>Why do we report the relative chance of crime rather than the raw chance of crime for each tract-hour as the main indicator? The goal of CrimeScape is to help law enforcement better understand patterns of crime activity to inform smarter decisions about where to allocate crime prevention resources. By reporting the relative chance of crime and the "surprise factor" for each census tract hourly, we hope to make it easy to see how expected crime patterns today differ from what we normally expect so police departments can adjust resources accordingly.</p>

<p>In particular, for users that are familiar with the city and have established expectations about which areas are more or less likely to experience crime, the surprise factor seeks to highlight cases where those assumptions do not hold. This could be an area with a below average crime rate that is predicted to have a moderate chance of crime at a certain time, or an area with an above average crime rate that is predicted to have a very high chance of crime at a certain time.</p>

<p>CrimeScape calculates the "surprise factor" using the following methodology. Every prediction that CrimeScape makes is stored in a database. When a new prediction is made, CrimeScape compares that prediction to "comparable" past predictions made for that area at comparable times. If the new prediction is greater than 95% of the comparable predictions, the prediction is highlighted as "surprising" for that area at the given time.</p>

<p>We consider a comparable prediction to be any prediction made for the same census tract on a similar day at a similar time within the past 30 days. For a weekend, similar days are both weekend days (e.g. for a prediction made on Sunday, we consider past predictions made on Saturday or Sunday). For a weekday, the similar day is only that same day (e.g. for a prediction made on Tuesday, we consider only predictions also made on a Tuesday). Similar times are hours within three hours of the time being predicted (e.g. 3PM-9PM for a prediction at 6PM).</p>

<!-- <p>Furthermore, incidents of crime are uncommon events, even in areas with relatively high crime rates.</p>
 -->
<h1>
<a id="evaluation" class="anchor" href="#evaluation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Evaluation</h1>

<p>Our main measure of accuracy is the <strong>ratio of hours correctly predicted to total hours for which predictions were made</strong>. We define an hour to be “correctly predicted” if 1) CrimeScape predicted criminal activity at 50-100% and a crime did occur or 2) CrimeScape predicted criminal activity at 0-49% and a crime did not occur. As of September 2015, CrimeScape is about 70% accurate by this measure.</p>

<p>We further evaluate our model along several different metrics. We calculate a <a href="http://www.dataschool.io/simple-guide-to-confusion-matrix-terminology/">confusion matrix</a> for our updated model that compares the predicted values with what actually happened. The metrics in the confusion matrix are calculated in the following way:</p>

<table border="1">
<tr>
<td></td>
<td colspan = "3"><strong>Actual Value (confirmed by occurrences)</strong></td>
</tr>
<tr>
<td rowspan = "3"><strong>Predicted Value</strong></td>
<td></td>
<td><em>Positive</em></td>
<td><em>Negative</em></td>
</tr>
<tr>
<td><em>Positive</em></td>
<td>TP (True Positive)</td>
<td>FP (False Positive)</td>
</tr>
<tr>
<td><em>Negative</em></td>
<td>FN (False Negative)</td>
<td>TN (True Negative)</td>
</tr>
</table>

<p><strong>True Positive Rate = TP / (TP + FN)</strong>
When crime did in fact occur, the true positive rate tells you the proportion of times that CrimeScape correctly predicted there would be a crime. It is the probability of success, given crime.</p>

<p><strong>False Positive Rate = FP / (FP + TN)</strong>
When crime did not occur, the false positive rate tells you the proportion of times that CrimeScape incorrectly predicted there would be a crime. It is the probability of failure, given no crime.</p>

<p>Our goal is to optimize to maximize true positives and minimize false negatives, while maintaining less than 15% false positives (as a maximum threshold).</p>

<h1>
<a id="additional-reading" class="anchor" href="#additional-reading" aria-hidden="true"><span class="octicon octicon-link"></span></a>Additional Reading</h1>

<p><a href="http://j.mp/lBZoIi">Logistic Regression in Rare Events Data</a>, Gary King and Langche Zeng (2001)</p>
      </section>
      <footer>
        <p><small>Hosted on <a href="https://pages.github.com">GitHub Pages</a> using the Dinky theme</small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
		
  </body>
</html>
